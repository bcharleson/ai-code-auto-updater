#!/bin/bash

# Get the project directory (parent of .app bundle)
PROJECT_DIR="$(cd "$(dirname "$0")/../../.." && pwd)"

# Function to show notification
show_notification() {
    osascript -e "display notification \"$2\" with title \"$1\""
}

# Function to show dialog
show_dialog() {
    osascript -e "display dialog \"$2\" with title \"$1\" buttons {\"OK\"} default button \"OK\""
}

# Change to project directory
cd "$PROJECT_DIR" || {
    show_dialog "Error" "Could not find project directory"
    exit 1
}

# Check if node_modules exists
if [ ! -d "node_modules" ]; then
    show_notification "Augment Updater" "Installing dependencies..."
    npm install
fi

# Run the updater in a new Terminal window with better visibility
osascript <<EOF
tell application "Terminal"
    activate
    set newTab to do script "cd '$PROJECT_DIR' && clear && echo 'ðŸš€ Augment Extension Updater' && echo '================================' && echo '' && npm start; echo ''; echo 'Press any key to close...'; read -n 1; exit"
end tell
EOF

